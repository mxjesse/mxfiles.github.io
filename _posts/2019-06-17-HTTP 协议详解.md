## HTTP 协议详解

### 序言
HTTP协议（HyperText Transfer Protocol，超文本传输协议）是因特网上应用最为广泛的一种网络传输协议，所有的WWW文件都必须遵守这个标准。HTTP是一个基于TCP/IP通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。

### HTTP概述
Web浏览器，服务器和相关的Web应用程序都是通过HTTP协议相互通信的，HTTP是现代因特网中使用的公共语言。

#### HTTP因特网的多媒体信使
每天，都有数以亿万计的 JPEG 图片、HTML 页面、文本文件、MPEG 电影、WAV 音频文件、Java 小程序和其他资源在因特网上游弋。HTTP 可以从遍布全世界的 Web 服务器上将这些信息块迅速、便捷、可靠地搬移到人们桌面上的 Web 浏览器上去。  	
HTTP使用的是可靠的数据传输协议，因此它能确保数据在传输过程中不被损坏或混乱，因此用户在访问信息的时不用担心数据完整性，开发人员也可以专注于应用程序的编写，而无需担心HTTP通信在传输过程中被破坏。

#### Web客户端和服务器
Web 内容都是存储在 Web 服务器上的。Web 服务器所使用的是 HTTP 协议，因此经常会被称为 HTTP 服务器，这些Web服务器存储了因特网中的数据。HTTP客户端向服务器发送 HTTP 请求，服务器会在 HTTP 响应中回送所请求的数据，HTTP 客户端和 HTTP 服务器共同构成了万维网的基本组件。  
最常见的客户端就是Web浏览器，如微软的IE，谷歌的Chrome，火狐的Firefox浏览器，Web 浏览器向服务器请求 HTTP 对象，并将这些对象显示在你的屏幕上。

#### Web资源（Web Resource）
Web服务器是Web资源的宿主。  
最简单的Web资源就是Web服务器文件系统中的静态文件：文本文件，html文件，word文件，JEPG图片文件，AVI电影文件等等。  
资源不一定静态的，资源还可以是根据需要生成内容的软件程序。这些动态内容资源可以根据你的身份、所请求的信息或每天的不同时段来产生内容。它们可以为你显示照相机中活生生的照片，也可以帮你进行股票交易，搜索房产数据库，或者从在线商店中购买礼物。

##### 媒体类型
互联网上有很多种不同的数据类型，HTTP要给每种要通过Web传输的对象打上MIME类型（MIME type）标签。

MIME（Multipurpose Internet Mail Extention，多用途因特网邮件拓展)最初设计是为了解决不同电子邮件系统之间搬运报文时存在的问题，MIME在电子邮件系统中工作得非常好，因此HTTP也采纳了它，用它来描述并标记多媒体内容。  
Web服务器会给所有HTTP对象附加一个MIME标签，当Web浏览器从Web服务器中取得一个对象时，会查看相关的MIME类型，然后浏览的知道会以何种方式处理这个对象，大多数浏览器都可以处理数百种常见的对象类型：显示图片文件、解析并格式化 HTML 文件、通过计算机声卡播放音频文件。

* HTML 格式的文本文档由 text/html 类型来标记。
* 普通的 ASCII 文本文档由 text/plain 类型来标记。
* JPEG 格式的图片为 image/jpeg 类型。
* GIF 格式的图片为 image/gif 类型。
* Apple 的 QuickTime 电影为 video/quicktime 类型。
* 微软的 PowerPoint 演示文件为 application/vnd.ms-powerpoint 类型。

##### URI
每个 Web 服务器资源都有一个名字，这样客户端就可以说明它们感兴趣的资源是什么了。服务器资源名被称为统一资源标识符（Uniform Resource Identifier, URI）。URI就像互联网上的邮政地址一样，在世界范围内唯一表识并定位信息资源，URI有如下两种表现形式：
  
 1. URL（Uniform Resource Location, 统一资源定位符)：URL 描述了一台特定服务器上某资源的特定位置。它们可以明确说明如何从一个精确、固定的位置获取资源。大部分 URL 都遵循一种标准格式，这种格式包含三个部分：
 	* 第一部分被称为方案（Schema），说明了访问资源的协议类型，在这里就是HTTP协议`"http://"`
 	* 第二部分给出了因特网的访问地址，如`"www.baidu.com"`
 	* 第三部分指定了Web服务器上某个资源，如 `"/imgFolder/flower.jpg"`
 2. URN（Uniform Resource Naming，统一资源名）：URN 是作为特定内容的唯一名称使用的，与目前的资源所在地无关。使用这些与位置无关的 URN，就可以将资源四处搬移。通过 URN，还可以用同一个名字通过多种网络访问协议来访问资源,“比如，不论因特网标准文档 RFC 2141 位于何处（甚至可以将其复制到多个地方），都可以用下列 URN 来命名它：`"urn:ietf:rfc:2141"`，URN 仍然处于试验阶段，还未大范围使用，了解即可。

##### 事务
一个HTTP事务由一条（从客户端发向服务器的）请求命令和一条（从服务器发回客户端的）响应结果组成，这种通信是通过名为HTTP报文（HTTP Message）的格式化数据块进行的。
![HTTP请求响应过程](https://github.com/mxjesse/mxjesse.github.io/raw/master/img_floder/201906/1560761854972.jpg)

* 方法：HTTP支持几种不同的请求命令，这些命令被称为HTTP方法（HTTP Methood），每条HTTP报文都包含一个方法，这个方法会告诉服务器要执行什么动作（获取一个Web页面，删除一个文件，更新一条数据库信息等），下边列出八种HTTP方法：

	HTTP方法 | 方 法 描 述
	:---: | :---:
	GET | 请求指定的页面信息，并返回实体主体
	POST | 向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和/或已有资源的修改。
	HEAD | 类似于get请求，只不过返回的响应中没有具体的内容，用于获取报头
	PUT | 从客户端向服务器传送的数据取代指定的文档的内容
	DELETE | 请求服务器删除指定的资源
	CONNECT | HTTP/1.1协议中预留给能够将连接改为管道方式的代理服务器
	OPTIONS | 允许客户端查看服务器的性能
	TRACE | 回显服务器收到的报文，主要用户测试或者诊断
* 状态码 每条HTTP响应报文都包含一个状态码，状态码是一个三位数数字代码，告知客户端是否请求成功，或者是否需要采取其他动作，下边列举常见状态码：

	HTTP状态码 | 描述
	:---: | :---: 
	200 | ok 正确返回
	302 | redirect 重定向，到其他地方获取资源
	404 | Not found 无法找到这个资源

	伴随着每个数字状态码，HTTP还会发送一条解释性短语文本，如：
	```
	200 OK
	```
	
* Web页面中可以包含多个对象：应用程序完成一项任务一般要发布多个HTTP事务，比如一个Web页面包含了多个图片，浏览器会执行一个事物来获取描述**页面布局**的HTML框架，然后发布另外的事物来获取每个嵌入式的图片、java小程序等，这些资源可能分布在不同的服务器上，所以，一个Web页面通常不是单个资源，而是一组资源的集合。

##### 报文
HTTP报文是由一行行的简单字符串组成的，HTTP报文是由字符串组成的，而不是二进制代码，所以可以很方便对其读写，